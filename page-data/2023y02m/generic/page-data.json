{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023y02m/generic/","result":{"data":{"site":{"siteMetadata":{"title":"코딩 주머니"}},"markdownRemark":{"id":"cb7d1452-1c84-5741-a959-b23fb4be26a3","excerpt":"…","html":"<p>스프링과 코틀린을 사용하면서 만난 문제를 정리하려고 한다. 실제 업무와 비슷하게 다이어그램을 작성해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/45d4ac8c261809320b6ce1471e641930/b5a09/classDiagram.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.81012658227847%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAABxElEQVR42pWUB47CQAxF5/4HA6Egeu8dQm+CUL161hqFtrCWrEnsnz+ucev1WubzuSyXS2k0GlIoFKRUKkm73VYbPjDX61VWq5XaRqOR4srlsup4PJbFYqE4N5vNxPd9NTabTalUKlKtVqXVaslkMlEfmMvlItPpVHGDwUCJwKHD4VDt4Fy/35d0Oi35fF4ymYwCIU6lUlKr1W6ESLfbVTtYlMuLxaJmZDjHbTgxckICIeS5XE6VS5Fer6fv4CCiRNls9maDy5EKej6f9aPNZqO1QMzOSQ0NyzN2IjK/nU5+BRBC4WmEAdAwxsiCINA0w37EGcjUhNvpHF3tdDpSr9e1SURPc3a73d0lpk8RWmqQQUqNIpGIRKNRicVi2hgI9/v903caYTjcsJNoaAYEzCQF55k0HwnDmT0RmhMSz/MkmUzqWHHSWVLHF075robvCImQsaB+NImTYWeQsdOUj4SPqZuwCail+Q73Zw2Px6Pq4XDQ+hEdHT6dTmqzuf2YMgKYwtvYsDn8DHi27m+32+8JGRs6an8dCHlGaQr7zgL8i5DFj8fjuqO2q3Q7kUioksHXhJz8joiSWUR5Zwaxoez8K8IfhCEQdumKNEAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"classDiagram\"\n        title=\"\"\n        src=\"/static/45d4ac8c261809320b6ce1471e641930/f058b/classDiagram.png\"\n        srcset=\"/static/45d4ac8c261809320b6ce1471e641930/c26ae/classDiagram.png 158w,\n/static/45d4ac8c261809320b6ce1471e641930/6bdcf/classDiagram.png 315w,\n/static/45d4ac8c261809320b6ce1471e641930/f058b/classDiagram.png 630w,\n/static/45d4ac8c261809320b6ce1471e641930/40601/classDiagram.png 945w,\n/static/45d4ac8c261809320b6ce1471e641930/78612/classDiagram.png 1260w,\n/static/45d4ac8c261809320b6ce1471e641930/b5a09/classDiagram.png 1360w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><code class=\"language-text\">convert(List&lt;Data>)</code>는 고정된 타입을 받아 <code class=\"language-text\">T</code>를 반환하고, <code class=\"language-text\">execute(T)</code>는 <code class=\"language-text\">T</code>타입을 받아 <code class=\"language-text\">ValidationResponse</code> 를 반환하는 것을 알 수 있다.<br>\n이 설계의 의도는 <strong>확장에 유연</strong>하고 <strong>검증하는 부분과 검증기가 필요로하는 데이터 타입을 가공하는 부분</strong>을 나누고 싶었다.<br>\n각 <code class=\"language-text\">ValidationImpl</code>은 <code class=\"language-text\">convert()</code>를 통해 <code class=\"language-text\">List&lt;Data></code>라는 타입을 받아 <strong>검증할 때 사용할 데이터 타입을 직접 정의할 수 있도록 했다.</strong></p>\n<ul>\n<li>\n<p><code class=\"language-text\">strategies</code>를 주입받을 떄 <strong><code class=\"language-text\">*</code> Star-projection</strong>을 사용하여 모든 구현체를 주입받아야 한다.</p>\n<ul>\n<li><code class=\"language-text\">*</code>로 하지 않고 <code class=\"language-text\">Any</code>로 주입받으면 빈을 찾지 못한다.</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">ValidationStrategy</code>의 제네릭을 <code class=\"language-text\">Any</code>로 작성하여 구현체마다 직접 다운 캐스팅을 하진 않을 것이다.</p>\n</li>\n</ul>\n<h1><strong>문제점</strong></h1>\n<p>위의 다이어그램과 같이 <code class=\"language-text\">Service</code>는 <code class=\"language-text\">ValidationStrategy</code> 인터페이스를 구현한 구현체를 <code class=\"language-text\">List&lt;ValidationStrategy></code>으로 주입받아 사용하려 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Service</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">Service</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> strategies<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>ValidationStrategy<span class=\"token operator\">&lt;</span><span class=\"token operator\">*</span><span class=\"token operator\">></span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>values<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>Data<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>ValidationResponse<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> strategies<span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">val</span> convertData <span class=\"token operator\">=</span> it<span class=\"token punctuation\">.</span><span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span>\n            it<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>convertData<span class=\"token punctuation\">)</span> <span class=\"token comment\">// COMPILE ERROR!!!</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span>\n            it<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> ValidationStrategy<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>param<span class=\"token operator\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> ValidationResponse\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>queries<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>Data<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> T\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token annotation builtin\">@Component</span>\n<span class=\"token keyword\">class</span> ValidationImpl1 <span class=\"token operator\">:</span> ValidationStrategy<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>param<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> ValidationResponse <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">ValidationResponse</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>queries<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>Data<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> String <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"가공 데이터\"</span></span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">data</span> <span class=\"token keyword\">class</span> <span class=\"token function\">ValidationResponse</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">val</span> message<span class=\"token operator\">:</span> String\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">data</span> <span class=\"token keyword\">class</span> <span class=\"token function\">Data</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">val</span> <span class=\"token keyword\">data</span> <span class=\"token operator\">:</span> String\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>하지만 <code class=\"language-text\">it.execute(convertData)</code>를 호출할 때 파라미터를 넘겨보면 <strong>컴파일 에러</strong>가 발생한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 607px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e918075f454f827cc1745a42fb02da99/ef9e5/nothing.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.44303797468354%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABfUlEQVR42kXR6Y6iQBSGYe9mGpCliqWgaNxaRRZBZZR26Taduf9reCfgJPPjyVfnz3eSOhPpWoTCIZCSMPCxB0ISq4j3LEMnIUII4jhGpymJfkclmiTNUHGM41pY1n8TyzKRzpREWiS+YK4S5pFinfqEKiYMI5JYoXVKmmpE4OO4DrY9sDFNA8N4MQ2DifRcLMcj8j3WM021WdJWC7b5glX+wWyVkmqFTjN0qvETRaQVUko8IfD9gCCMxpS+z8S2p9iezyoLWWQJgZqxXM757M887lc+rz3d+UxRlay3OfmuYLsryIuCfLd7ZVGwK0vWmw8mpmViTl2E56CGbUKhwpDb/cbz54fz5cL385vj6URZV1T7+p/9S12P6rZls90ymdoWlu1gmNb4D29vv3Bcl/P1wf35h66/0vU3qkNH1Z5emgN1s6dqmnEumwP7tmU9FA6XMU2T4Tjj2zAQQlKerhTdF8Whp+weVIPfX688Xmjadiyuujvlsac5HMfCvzNS8j0K6+qJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nothing\"\n        title=\"\"\n        src=\"/static/e918075f454f827cc1745a42fb02da99/ef9e5/nothing.png\"\n        srcset=\"/static/e918075f454f827cc1745a42fb02da99/c26ae/nothing.png 158w,\n/static/e918075f454f827cc1745a42fb02da99/6bdcf/nothing.png 315w,\n/static/e918075f454f827cc1745a42fb02da99/ef9e5/nothing.png 607w\"\n        sizes=\"(max-width: 607px) 100vw, 607px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이 에러를 보고 고민했을 때 아래와 같은 방법들이 떠올랐다.</p>\n<h2><strong>첫 번째 방법 : 리플렉션</strong></h2>\n<p><em>직접 해보진 않았지만</em> 리플렉션을 사용하여 주입받은 <code class=\"language-text\">ValidationStrategy.execute()</code>의 타입 파라미터와 메소드를 조회화여, 찾은 타입 파라미터로 캐스팅하거나 찾은 메소드로 <code class=\"language-text\">invoke</code>하는 방법</p>\n<ul>\n<li>코드 복잡성이 높아진다.</li>\n<li>가독성이 급격히 떨어진다.</li>\n<li><strong>개인적으로는 리플렉션 같은 메타 프로그래밍을 선호하지 않는다.</strong></li>\n</ul>\n<h2><strong>두 번째 방법 : 파라미터 추상화</strong></h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2fcdac3d96b2ef72a3ab2399d37172be/27f8b/abstracParameter.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.51898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABgklEQVR42o2T6Y7CMAyE8/7vhfiDAHHTcpT7LEe5Ki6vPktG3apdNpJVx5lMJuPUvd9veT6fGq/XS5hbjfnlcpHtdiubzUZzaqwlcRbM3fV61Q2Hw0Hm87nU63VptVqa7/d7Jbrf7xphGCpuMpkortlsymKxUNx6vZbb7SbudDpJu91WEoK8VqvpBt/3lRhlx+NRCbJw/X5flsulIM6dz2fxPE+63a5+e72eBEGgeafT0TqHEuTUsnAcDpczLwgGG1Fjw+rpHAxYBr6a/05SgwWkR1Gk3ziO9WSC3NbwC2x6/FJoCthEMzB7OBxKoVCQYrGoV9ztdh+/THUyXPI6Roia6XQqs9lMRqORjMdjGQwGSr5arfSwNOFHYVKuLfA0yuWylEolqVar2slGo6G1SqWizeHaaV9zCR+PhyogeDKo4q3anGaA+UqY1VWMt+tbJ7OwuQqTjcF8/MI/3h05f0aef38qpDH2Z/BoyfERP1n7l8IkCBUos+5yZX4xAh/zCH8AG9Yv94cxxtIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"abstracParameter\"\n        title=\"\"\n        src=\"/static/2fcdac3d96b2ef72a3ab2399d37172be/f058b/abstracParameter.png\"\n        srcset=\"/static/2fcdac3d96b2ef72a3ab2399d37172be/c26ae/abstracParameter.png 158w,\n/static/2fcdac3d96b2ef72a3ab2399d37172be/6bdcf/abstracParameter.png 315w,\n/static/2fcdac3d96b2ef72a3ab2399d37172be/f058b/abstracParameter.png 630w,\n/static/2fcdac3d96b2ef72a3ab2399d37172be/40601/abstracParameter.png 945w,\n/static/2fcdac3d96b2ef72a3ab2399d37172be/78612/abstracParameter.png 1260w,\n/static/2fcdac3d96b2ef72a3ab2399d37172be/27f8b/abstracParameter.png 1730w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>좋은 방법이긴 하지만 <a href=\"https://github.com/jdalma/java-to-kotlin#15%EC%9E%A5-%EC%BA%A1%EC%8A%90%ED%99%94%ED%95%9C-%EC%BB%AC%EB%A0%89%EC%85%98%EC%97%90%EC%84%9C-%ED%83%80%EC%9E%85-%EB%B3%84%EB%AA%85%EC%9C%BC%EB%A1%9C\">자바에서 코틀린으로 15장. 캡슐화한 컬렉션에서 타입 별명으로</a>을 보면 자료구조를 클래스로 캡슐화하게 되면 <strong>코틀린 표준 라이브러리가 제공하는 기능을 사용하기에는 불편하기 때문에 제외하였다.</strong></p>\n<h2><strong>세 번째 방법 : 타입을 명시적으로</strong></h2>\n<p><code class=\"language-text\">ValidationStrategy</code>은 <strong>받아들이는 제네릭 파라미터와 반환하는 파라미터 타입이 같기 때문에</strong> 한정적 와일드카드를 적용하기에는 힘들다고 판단했다.<br>\n이런 상황을 해결하기 위한 방법을 <a href=\"https://github.com/jdalma/footprints/blob/main/effective-java/item31_%ED%95%9C%EC%A0%95%EC%A0%81%20%EC%99%80%EC%9D%BC%EB%93%9C%EC%B9%B4%EB%93%9C%EB%A5%BC%20%EC%82%AC%EC%9A%A9%ED%95%B4%20API%20%EC%9C%A0%EC%97%B0%EC%84%B1%EC%9D%84%20%EB%86%92%EC%9D%B4%EB%9D%BC.md\">Effective Java Item 31 내용 중 비한정적 타입 매개변수와 비한정적 와일드카드</a>에서 소개한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> j<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    list<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>List의 타입이 <code class=\"language-text\">List&lt;?></code>인데, <code class=\"language-text\">List&lt;?></code>에는 <strong>null</strong>외에는 어떤 값도 넣을 수 없기 때문에 컴파일 에러가 발생한다.<br>\n코틀린의 <code class=\"language-text\">*</code>이 <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-nothing.html\"><code class=\"language-text\">kotlinlang</code> Nothing</a>을 기대하는 이유가 <a href=\"https://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html\"><code class=\"language-text\">Java tutorial</code> Wildcards</a>를 확인해보면 <strong>와일드카드를 통해 모든 타입을 적용할 수 있게 되지만 쓰는 것에 대해서는 안전하지가 않다는 것을 알 수 있다.</strong></p>\n<p>이 상황은 <code class=\"language-text\">ValidationStrategy</code>의 상황과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Service</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">Service</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> strategies<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>ValidationStrategy<span class=\"token operator\">&lt;</span><span class=\"token operator\">*</span><span class=\"token operator\">></span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>values<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>Data<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>ValidationResponse<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> strategies<span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// execute를 하기위해 파라미터를 넘겨야 하는데 인자 타입을 알 수 없다.</span>\n            strategy<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>strategy<span class=\"token punctuation\">.</span><span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>queries<span class=\"token punctuation\">.</span><span class=\"token function\">toList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span>\n            it<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이펙티브 자바 책에서는 아래와 같은 <code class=\"language-text\">helper method</code>에 제네릭을 작성하여 실제 타입을 알려주면서 해결하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 와일드카드 타입을 실제 타입으로 바꿔주는 private 도우미 메서드</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">E</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">void</span> <span class=\"token function\">swapHelper</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">E</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> j<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    list<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>j <span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2><strong>타입을 명시적으로</strong></h2>\n<p>위의 <code class=\"language-text\">helper method</code>를 참고하여 아래와 같이 작성해보았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>values<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>Data<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>ValidationResponse<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> strategies<span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span>\n        it <span class=\"token keyword\">as</span> ValidationStrategy<span class=\"token operator\">&lt;</span>Any<span class=\"token operator\">></span>\n        it<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">.</span><span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span>\n        it<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 또는</span>\n\n<span class=\"token keyword\">fun</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>values<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>Data<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>ValidationResponse<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> strategies<span class=\"token punctuation\">.</span>filterIsInstance<span class=\"token operator\">&lt;</span>ValidationStrategy<span class=\"token operator\">&lt;</span>Any<span class=\"token operator\">></span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span>\n            it<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">.</span><span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span>\n            it<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">strategies.filterIsInstance&lt;ValidationStrategy&lt;Any>>()</code>를 통해 <code class=\"language-text\">*</code>을 <code class=\"language-text\">Any</code>로 확정지어주면서 해결했다.</p>\n<ul>\n<li><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/filter-is-instance.html\"><code class=\"language-text\">kotlinlang</code> Iterable&#x3C;*>.filterIsInstance()</a> 확장함수가 <code class=\"language-text\">Iterable&lt;*></code>이므로 Star-Projections를 사용했을 때 타입을 확정지어줄 수 있게 제공하는 것 같다.</li>\n</ul>\n<p>추가적으로 <a href=\"https://jdalma.github.io/2023y02m/kotlinGeneric\">제네릭을 정리해 보았다.</a></p>","frontmatter":{"title":"코틀린 * 사용하기","date":"February 17, 2023","description":null,"tags":["Kotlin","Spring"]}},"previous":{"fields":{"slug":"/2023y02m/request/"},"frontmatter":{"title":"BlockingIO와 NonBlockingIO (작성중)"}},"next":{"fields":{"slug":"/2023y02m/kotlinGeneric/"},"frontmatter":{"title":"코틀린의 와일드카드와 제네릭에 대해"}}},"pageContext":{"id":"cb7d1452-1c84-5741-a959-b23fb4be26a3","previousPostId":"d729e334-539e-527c-8a84-306d2d2769b5","nextPostId":"13d71053-d1ee-5538-86a2-adac27245f3a"}},"staticQueryHashes":["230163734","3589320610"],"slicesMap":{}}