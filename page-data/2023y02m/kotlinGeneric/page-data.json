{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023y02m/\bkotlinGeneric/","result":{"data":{"site":{"siteMetadata":{"title":"코딩 주머니"}},"markdownRemark":{"id":"d1412bfa-07c8-59f6-9b12-a22d044eb321","excerpt":"…","html":"<p><a href=\"https://jdalma.github.io/2023y02m/generic/\">스프링에서 코틀린의 <code class=\"language-text\">*</code>을 사용</a>하면서 만난 문제를 정리해봤었는데, 이 참에 제네릭을 정리해보고자 한다.</p>\n<h1><strong>코틀린의 제네릭과 한정적 와일드카드</strong></h1>\n<p>일단 <strong>타입 매개변수</strong>와 <strong>타입 인수</strong>를 알고가자<br>\n매개변수는 메서드 선언에 정의한 변수이고, 인수는 메서드 호출시 넘기는 실젯값이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">}</span>\n<span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">T</code>는 <strong>타입 매개변수</strong>가 되고, <code class=\"language-text\">Integer</code>는 <strong>타입 인수</strong>가 된다.</p>\n<p>이제 <strong>공변 <code class=\"language-text\">covariance</code>, 반공변 <code class=\"language-text\">contravariant</code>, 무공변 <code class=\"language-text\">invariance</code></strong> 에 대해, <strong>코틀린의 <code class=\"language-text\">in</code>, <code class=\"language-text\">out</code>, <code class=\"language-text\">where</code></strong> 은 어떤 개념인지 알아보자</p>\n<p><strong>변성</strong>에 대한 이야기는 <code class=\"language-text\">타입 T1이 T2의 하위 타입일 때, List&lt;T1>가 List&lt;T2>의 타입 관계가 어떠한가?</code>로 시작된다.</p>\n<blockquote>\n<p><a href=\"https://kotlinlang.org/docs/java-interop.html#java-generics-in-kotlin\"><code class=\"language-text\">kotlinlang</code> Java Generics in Kotlin</a>를 확인하면<br>\n<code class=\"language-text\">Foo&lt;? extends Bar></code> becomes <code class=\"language-text\">Foo&lt;out Bar!>!</code><br>\n<code class=\"language-text\">Foo&lt;? super Bar></code> becomes <code class=\"language-text\">Foo&lt;in Bar!>!</code> 이렇게 사용한다.<br>\n<code class=\"language-text\">!</code> 는 <code class=\"language-text\">Bar</code>와 <code class=\"language-text\">Bar?</code> 둘 다 의미한다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span>\n<span class=\"token keyword\">open</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Shelter</span>\n<span class=\"token keyword\">open</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Cage</span> <span class=\"token operator\">:</span> <span class=\"token class-name\">Shelter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Animal</span> <span class=\"token operator\">:</span> <span class=\"token class-name\">Cage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nfun 무공변<span class=\"token punctuation\">(</span>relation<span class=\"token operator\">:</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Cage</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\nfun 공변<span class=\"token punctuation\">(</span>relation<span class=\"token operator\">:</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>out <span class=\"token class-name\">Cage</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\nfun 반공변<span class=\"token punctuation\">(</span>relation<span class=\"token operator\">:</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>in <span class=\"token class-name\">Cage</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\nfun <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    val shelter <span class=\"token operator\">=</span> object <span class=\"token operator\">:</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Shelter</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    val cage <span class=\"token operator\">=</span> object <span class=\"token operator\">:</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Cage</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    val animal <span class=\"token operator\">=</span> object <span class=\"token operator\">:</span> <span class=\"token class-name\">Step</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Animal</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    무공변<span class=\"token punctuation\">(</span>shelter<span class=\"token punctuation\">)</span>    <span class=\"token comment\">// Type mismatch Compile Error !!!</span>\n    무공변<span class=\"token punctuation\">(</span>cage<span class=\"token punctuation\">)</span>\n    무공변<span class=\"token punctuation\">(</span>animal<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// Type mismatch Compile Error !!!</span>\n\n    공변<span class=\"token punctuation\">(</span>shelter<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// Type mismatch Compile Error !!!</span>\n    공변<span class=\"token punctuation\">(</span>cage<span class=\"token punctuation\">)</span>\n    공변<span class=\"token punctuation\">(</span>animal<span class=\"token punctuation\">)</span>\n\n    반공변<span class=\"token punctuation\">(</span>shelter<span class=\"token punctuation\">)</span>\n    반공변<span class=\"token punctuation\">(</span>cage<span class=\"token punctuation\">)</span>\n    반공변<span class=\"token punctuation\">(</span>animal<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// Type mismatch Compile Error !!!</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><a href=\"https://sungjk.github.io/2021/02/20/variance.html\">예제 참고</a></li>\n<li><a href=\"https://github.com/jdalma/footprints/blob/main/effective-java/item28_%EB%B0%B0%EC%97%B4%EB%B3%B4%EB%8B%A4%EB%8A%94%20%EB%A6%AC%EC%8A%A4%ED%8A%B8%EB%A5%BC%20%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC.md\">invariance/non-variance 참고 <code class=\"language-text\">Effective Java Item 28. 배열보다는 리스트를 사용하라</code></a></li>\n<li><a href=\"https://github.com/jdalma/footprints/blob/main/effective-java/item31_%ED%95%9C%EC%A0%95%EC%A0%81%20%EC%99%80%EC%9D%BC%EB%93%9C%EC%B9%B4%EB%93%9C%EB%A5%BC%20%EC%82%AC%EC%9A%A9%ED%95%B4%20API%20%EC%9C%A0%EC%97%B0%EC%84%B1%EC%9D%84%20%EB%86%92%EC%9D%B4%EB%9D%BC.md#pecs--producer-extends-consumer-super\">PESC 공식 참고 <code class=\"language-text\">Effective Java Item 31. 한정적 와일드카드</code></a></li>\n</ul>\n<p><strong>무공변</strong>은 제네릭 타입 파라미터가 고정되어 있는 상황으로 <strong>타입관계가 성립되지 않는 것</strong><br>\n<strong>공변</strong>은 하위 타입이 상위 타입과 관계를 성립 하는 것 <strong><code class=\"language-text\">Step&lt;Animal></code> is a <code class=\"language-text\">Step&lt;Cage></code></strong><br>\n<strong>반공변</strong>은 공변과 반대로 <strong><code class=\"language-text\">Step&lt;Shelter> is a Step&lt;Cage></code></strong></p>\n<p>여기서 추가로 <strong>PECS 공식</strong>이 등장하는데 <code class=\"language-text\">producer-extends, consumer-super</code>를 의미한다.<br>\n즉, <code class=\"language-text\">Collection&lt;T></code>에 대해 <strong>쓰기 작업은 <code class=\"language-text\">extends</code></strong> , <strong>읽기 작업은 <code class=\"language-text\">super</code></strong> 를 사용하라고 하는 공식이다.<br>\n넣을 때는 제네릭 타입 파라미터 기준 하위 타입들까지 허용하도록 하고, 꺼낼 때는 상위 타입들로 꺼낼 수 있도록 하는 것이다. <a href=\"https://ko.wikipedia.org/wiki/%EB%A6%AC%EC%8A%A4%EC%BD%94%ED%94%84_%EC%B9%98%ED%99%98_%EC%9B%90%EC%B9%99\">리스코프 치환 원칙</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 544px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6314600beba76d3d119a3795937ba3e6/b3e51/wildcards.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.34177215189874%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACZUlEQVR42o1UaYviQBD1//+LWfDr7HzQFQ8ExfUaRdExGXNojBoTL1Q8Y5K3VGU66rgsW9B0pVP96tXVMQAIggC+7/Neq9VQKBTQbrdRqVQwHA6xXC6x2Wz4rNVqoV6vI5/PY7fb0XV4nsd3SWJC+ZdYloXD4fBwRgS+C53FSNnv9xiPx1BVlZdpmuj1ephMJn8FnM1mbEPsDcOAJEmMwQyJbrVaRTKZxNvbGzKZDOvxeJz31WoFx3EYkKLpdrtIp9N4ff2JbDaLRCKBl5cfKBaLbBe7Xq/MjjwSI/JOO7Ei75Sne0A6I1vbtjGfz/kfrcFgwM5j+A+x7RmOx8ccEphtOwy8Wq2jcy6KqLKodBD4X98eG5mjKXbbfXRJURRMp1Os12tst1tIkswsH6osgMXiqnkBBhKgSQfovSssIwTs9xXcd4cInQEF2LMEOB8Boy/Ab7qqKrhcLlHrWNYMjjN/ZEheZFnmRYknOR8DTHT678PzfIxJD8KQ6fvWRvZzyAR0Pp/ZK/VgBDi4cTZVnwE1TePJWSwW3AWUTyL0AEhGQkI9gHsGdPkCTfvEyDAx0YHAB7eIaY5RKpXQbDY5IgJnQJEHYhUammxEcjlR3q6QPz+gKhqmA0Qh348etU4UsvjR6XR4+Gkvl8t8duIcPodMRXFdNyomDUMESKMneksYhLqH08EPQeDDdX2MVI+r3Vf636psMcuobUho0IXoui46B/bobmK+dMMYPjSYeN4YkPJF7xs9BBQq6TTw9XoN5XIF+eQYH40jWr/3yP2S8P5eQyqVQqFQZNtGo4F0OoNcLsfz/gcxuAEjO4l+7AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"wildcards\"\n        title=\"\"\n        src=\"/static/6314600beba76d3d119a3795937ba3e6/b3e51/wildcards.png\"\n        srcset=\"/static/6314600beba76d3d119a3795937ba3e6/c26ae/wildcards.png 158w,\n/static/6314600beba76d3d119a3795937ba3e6/6bdcf/wildcards.png 315w,\n/static/6314600beba76d3d119a3795937ba3e6/b3e51/wildcards.png 544w\"\n        sizes=\"(max-width: 544px) 100vw, 544px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>타입 인수에 대해 자바의 <code class=\"language-text\">?</code> 같은 방식으로 모든 타입을 수용하고 안전한 방식으로 사용하기 위해 <a href=\"https://kotlinlang.org/docs/generics.html#star-projections\"><code class=\"language-text\">kotlinlang</code> Start-Projections</a>이 제공된다. <strong>Start-Projections</strong>을 이해하는데 한정적 와일드카드가 도움이 된다.</p>\n<p><code class=\"language-text\">interface Function&lt;in T, out U></code><br>\n<code class=\"language-text\">Function&lt;*, String></code> → <code class=\"language-text\">Function&lt;in Nothing, String></code><br>\n<code class=\"language-text\">Function&lt;Int, *></code> → <code class=\"language-text\">Function&lt;Int, out Any?></code><br>\n<code class=\"language-text\">Function&lt;*, *></code> → <code class=\"language-text\">Function&lt;in Nothing, out Any?></code></p>\n<p>그렇다면 코틀린의 <code class=\"language-text\">where</code>은 무엇일까?<br>\n<a href=\"https://kotlinlang.org/docs/generics.html#upper-bounds\"><code class=\"language-text\">kotlinlang</code> Upper Bounds</a>를 보면 기본적으로 <code class=\"language-text\">&lt;></code>에 하나의 상한만 지정이 가능하지만 둘 이상의 상한이 필요한 경우 사용할 수 있다고 한다.<br>\n<strong>전달된 유형은 절의 모든 조건을 동시에 만족해야한다.</strong> 아래의 예제를 확인해보자</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">interface</span> Cage\n<span class=\"token keyword\">class</span> Animal <span class=\"token operator\">:</span> Cage\n<span class=\"token keyword\">class</span> Birds <span class=\"token operator\">:</span> Cage\n\n<span class=\"token keyword\">interface</span> Person\n<span class=\"token keyword\">class</span> Trainer <span class=\"token operator\">:</span> Cage<span class=\"token punctuation\">,</span> Person\n<span class=\"token keyword\">class</span> Developer <span class=\"token operator\">:</span> Person\n\n<span class=\"token keyword\">interface</span> WhereStep<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> <span class=\"token keyword\">where</span> T <span class=\"token operator\">:</span> Cage<span class=\"token punctuation\">,</span> T <span class=\"token operator\">:</span> Person\n\n<span class=\"token keyword\">fun</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">val</span> animal <span class=\"token operator\">=</span> <span class=\"token keyword\">object</span> <span class=\"token operator\">:</span> WhereStep<span class=\"token operator\">&lt;</span>Animal<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>          <span class=\"token comment\">// Type argument is not within its bounds. Compile Error !!!</span>\n    <span class=\"token keyword\">val</span> birds <span class=\"token operator\">=</span> <span class=\"token keyword\">object</span> <span class=\"token operator\">:</span> WhereStep<span class=\"token operator\">&lt;</span>Birds<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>            <span class=\"token comment\">// Type argument is not within its bounds. Compile Error !!!</span>\n    <span class=\"token keyword\">val</span> trainer <span class=\"token operator\">=</span> <span class=\"token keyword\">object</span> <span class=\"token operator\">:</span> WhereStep<span class=\"token operator\">&lt;</span>Trainer<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">val</span> developer <span class=\"token operator\">=</span> <span class=\"token keyword\">object</span> <span class=\"token operator\">:</span> WhereStep<span class=\"token operator\">&lt;</span>Developer<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>    <span class=\"token comment\">// Type argument is not within its bounds. Compile Error !!!</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">WhereStep</code> 인터페이스는 <code class=\"language-text\">Cage</code>와 <code class=\"language-text\">Person</code> 둘 다 만족해야 하기 때문에 <code class=\"language-text\">Trainer</code>만 구현 가능한 것을 확인할 수 있다.</p>","frontmatter":{"title":"코틀린의 와일드카드와 제네릭에 대해","date":"February 18, 2023","description":null,"tags":["Kotlin","Generic","lab"]}},"previous":{"fields":{"slug":"/2023y02m/generic/"},"frontmatter":{"title":"코틀린 * 사용하기"}},"next":null},"pageContext":{"id":"d1412bfa-07c8-59f6-9b12-a22d044eb321","previousPostId":"cb7d1452-1c84-5741-a959-b23fb4be26a3","nextPostId":null}},"staticQueryHashes":["230163734","3589320610"],"slicesMap":{}}